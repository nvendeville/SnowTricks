{% extends 'base.html.twig' %}

{% block title %}SnowTricks{% endblock %}

{% block body %}

    <section id="hero"
            style="background: url(img/hero3.jpg); background-size: cover; background-position: center center; height: 40rem"
            class="hero">
        <div class="container slogan">
            <div class="row">
                <div class="col-lg-12">
                    <p class="text-uppercase text-blue mb-0">Enjoy mountains and snowboard</p>
                </div>
            </div>

        </div>


    </section>

    <div id="arrowsDown" class="dis-flex justify-content-center pt-3">
        <a href=#listTricks>
            <i class="fas fa-angle-double-down fa-2x text-gray-900"></i>
        </a>
    </div>
    <div id="listing">
        <div id="listingTitle" style="display:none;" class="pt-4 container text-center pb-3">
            <h1>Choississez votre trick</h1>
        </div>

        <div id="listTricks" style="display:none;" class="dis-flex flex-wrap justify-content-center">
            {% set featuredImgs = '' %}
            {% for trick in tricks %}
                {% for media in trick.media %}
                    {% if media.featuredImg == 1 %}
                        {% set featuredImgs = media.link %}
                    {% endif %}
                {% endfor %}
                <a class="col-lg-2 col-md-4 px-md-1 py-1 trick-container no-padding destination d-flex align-items-end bg-center bg-cover" href="/{{ trick.slug }}" style="background: url(img/{{ featuredImgs }})">
                    <div class="destination-inner width-trick text-center text-white index-forward has-transition">
                        <p class="small text-uppercase mb-0">{{ trick.category.name }}</p>
                        <h2 class="h3 mb-4">{{ trick.name }}</h2>
                        <div class="dis-flex justify-content-around btn btn-primary btn-block destination-btn text-white">
                            <div>
                                <i class="fas fa-pencil-alt"></i>
                            </div>
                            <div>
                                <i class="fas fa-trash-alt"></i>
                            </div>
                        </div>
                    </div>
                </a>
            {% endfor %}
        </div>

        <div id="divLoadmore" style="display:none;" class="dis-flex justify-content-center pb-3 pt-3 ">
            <button id="loadMore" type="button" class="btn text-uppercase text-inherit btn-dark text-white">Voir plus</button>
        </div>
    </div>


    <div id="arrowsDowntest" class="dis-flex justify-content-center pt-3">
        <a href=#listTrickstest>
            <i class="fas fa-angle-double-down fa-2x text-gray-900"></i>
        </a>
    </div>
    <div id="listingtest" >
        <div id="listingTitletest" class="pt-4 container text-center pb-3">
            <h1>TEST Choississez votre trick</h1>
        </div>

        <div id="listTrickstest" class="dis-flex flex-wrap justify-content-center">
            {% set featuredImgs = '' %}
            {% for trick in tricks %}
                {% for media in trick.media %}
                    {% if media.featuredImg == 1 %}
                        {% set featuredImgs = media.link %}
                    {% endif %}
                {% endfor %}
                <a id="aTrick" class="col-lg-2 col-md-4 px-md-1 py-1 trick-container no-padding destination d-flex align-items-end bg-center bg-cover" href="/{{ trick.slug }}" style="background: url(img/{{ featuredImgs }}); display:none;">
                    <div class="destination-inner width-trick text-center text-white index-forward has-transition">
                        <p class="small text-uppercase mb-0">{{ trick.category.name }}</p>
                        <h2 class="h3 mb-4">{{ trick.name }}</h2>
                        <div class="dis-flex justify-content-around btn btn-primary btn-block destination-btn text-white">
                            <div>
                                <i class="fas fa-pencil-alt"></i>
                            </div>
                            <div>
                                <i class="fas fa-trash-alt"></i>
                            </div>
                        </div>
                    </div>
                </a>
            {% endfor %}
        </div>

        <div id="divLoadmoretest" class="dis-flex justify-content-center pb-3 pt-3 ">
            <button id="loadMoretest" type="button" class="btn text-uppercase text-inherit btn-dark text-white">Voir plus</button>
        </div>
    </div>

{% endblock %}
{% block otherScript %}
    <script>
        $(document).ready(function () {
            $('#arrowsDowntest').click(function() {
                $('#listTricks').show(1000)
            });

            let offset = {{ offset }}

            $('#arrowsDown').click(function() {
                $('#listingTitle').toggle(1000)
                $('#listTricks').toggle(1000)
                $('#divLoadmore').toggle(1000)
            });


            $('#loadMore').click(function() {

                $('#listTricks').show(1000);

                $("#divLoadmore").removeClass('pt-3 pb-3')

                $.ajax({
                    url : '/',
                    type : 'GET',
                    data : 'offset=' + offset,
                    dataType : 'json',
                    success : function(data){
                        let tricks = JSON.parse(data.tricks)
                        if(tricks.length>0){
                            for (let trick of tricks){
                                $("<a></a>")
                                    .addClass('col-lg-2 col-md-4 px-md-1 py-1 trick-container no-padding destination d-flex align-items-end bg-center bg-cover')
                                    .attr('href', '/' + trick.slug)
                                    .attr('style', "background: url(img/" + trick.img + ")")
                                    .append($('<div  class="destination-inner width-trick text-center text-white index-forward has-transition"></div>')
                                        .append($('<p class="small text-uppercase mb-0">' + trick.category + '</p>'))
                                        .append($('<h2 class="h3 mb-4">' + trick.name + '</h2>'))
                                        .append($('<div  class="dis-flex justify-content-around btn btn-primary btn-block destination-btn text-white"></div>')
                                            .append($('<div><i class="fas fa-pencil-alt"></i></div>'))
                                            .append($('<div><i class="fas fa-trash-alt"></i></div>'))
                                        )
                                    ).appendTo($('#listTricks'))
                            }
                        }
                        offset += 5
                    }
                });

            });

            $('#scrollToTitle').click(function() {
                $("html, body").animate({scrollTop:$('#listingTitle').offset().top}, 1000);
            });
        });

    </script>

{% endblock %}
